{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix Radix Select crash for empty/invalid task status in Task edit flow",
  "requirements": [
    {
      "id": "REQ-63",
      "summary": "Harden Task status Select so empty/whitespace/invalid stored statuses never control Radix Select with an empty string and always fall back to a safe non-empty sentinel; ensure sentinel submits status: null.",
      "acceptanceCriteria": [
        "Opening the Edit Task dialog for a task with status === \"\" does not crash and renders the dialog normally.",
        "In frontend/src/components/tasks/TaskFormDialog.tsx, when initializing edit-mode state, empty-string/whitespace status values are mapped to the existing STATUS_NONE_SENTINEL (\"__none__\") instead of being passed through to the Select as \"\".",
        "If an existing task has a status value that is not in ALLOWED_TASK_STATUSES (e.g., legacy or malformed), the dialog does not crash and the status field falls back to the sentinel (\"None\") or a normalized allowed value (if normalization is applied).",
        "Submitting an edited task with the sentinel selected results in sending status: null (i.e., clearing status) rather than sending an empty string.",
        "No SelectItem in the Task edit flow uses value=\"\" and no Select component in the Task edit flow receives \"\" as its controlled value."
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/tasks/TaskFormDialog.tsx",
          "operation": "modify",
          "description": "Add a small status coercion/normalization step when populating edit-mode state so task.status values that are empty/whitespace or not in ALLOWED_TASK_STATUSES never reach the <Select> as \"\" or an invalid value; map them to STATUS_NONE_SENTINEL (\"__none__\") or a normalized allowed value. Ensure submit logic continues to translate STATUS_NONE_SENTINEL to status: null (never an empty string)."
        },
        {
          "path": "frontend/src/constants/taskStatus.ts",
          "operation": "modify",
          "description": "Improve status normalization/validation utilities to be null/whitespace-safe (e.g., trim input before mapping) so TaskFormDialog can reliably normalize legacy values and detect unknown/invalid statuses for fallback to the sentinel."
        },
        {
          "path": "frontend/src/components/tasks/TaskBulkEditDialog.tsx",
          "operation": "modify",
          "description": "Remove any Radix <SelectItem> that uses value=\"\" by introducing a non-empty sentinel for the bulk-edit 'Leave unchanged' option, and ensure the controlled <Select> value never becomes \"\". Keep behavior the same (no status update applied when 'Leave unchanged' is selected)."
        }
      ]
    }
  ]
}